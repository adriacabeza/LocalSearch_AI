\documentclass[12]{article}
\usepackage[utf8]{inputenc}
\usepackage{cite}
\author{Carlos Bergillos, Roger Vilaseca, Adri√† Cabeza}
\title{\textbf{Sharing cars to get to work:\\ A Local Search approach}\\ \bigskip Artificial Intelligence}
\date{\today}
\usepackage{listings}
\lstset{
  basicstyle=\ttfamily,
  showstringspaces=false,
  commentstyle=\color{orange},
  keywordstyle=\color{blue},
	frame=tb,language=C,breaklines=true,numbers=none,  stringstyle=\color{red}, tabsize=3,   showstringspaces=false,
  columns=flexible, 
}
\usepackage{graphicx}
\begin{document}
\maketitle
\vspace*{\fill}
\begin{center}
\includegraphics[scale=0.5]{images/UPClogo.png}
\end{center}

\newpage
\tableofcontents
\newpage
\section{Introduction}
For this assignment we are assuming a car sharing system where all the users are sharing the car. We have $N$ people and $M$ drivers. which is a subset of $N$. 

Our city is a $10\times10\ km$ square and each street is disposed...

\section{Description of the problem}

The calculation of the distance between two points of the city will be made using the following function: 

$$ d(i,j) = \mid i_x - j_x\mid+ \mid i_y - j_y\mid $$
where $i_x$ and $i_y$ are the coordinates $x$ and $y$ of the $i$ point in the grid. 
\section{Representation of a problem state}
\section{Generating an initial solution}
We have to make a representation fo the initial state, which at the same time is a solution state. We have implemented four different ways to generate our initial state:
\begin{enumerate}
\item 
\item 
\item Taking all the people that are not drivers inside the first car's queue.
\item Taking all the people that are not drivers inside the first car's queue.
\end{enumerate} 
\section{Analysis of our operators}

Once we have defined the structure we will work with, we have to decide which operators will modify our structure to move from one  state to another. To do this, we must take into account several factors, so that when executing our algorithm, the best possible solution is found in a fairly reasonable execution time. 
\\
Our operators indicate all the possible paths that can be taken given any state. Then we will use all these possibilities with the objective that this becomes a state with some favorable characteristics. This is called a branch factor and it changes the way it is applied depending on which algorithm we are using. In the \textbf{Hill Climbing}, we generate all the successors and the heuristic decides if it is good enough to stay with him, in the \textbf{Simulated Annealing} we generate a successor status in a random way and the heuristic decides if it is good enough to stay with him. 
\\
\medskip

It is really important to cover all the space of solutions with our operators because if we are not doing it, there may exist solutions that will be lost, which could prevent us from reaching an optimal solution. Also we be cautious about creating repeated solutions because our execution time would be affected. 
\\

At the beginning of everything we made a brainstorming session with all the operators we could think of, which we believed that could be useful and serve for something: swap the order of the people inside a car, swap outside people between cars, deleting cars, moving a person into another car, etc...

Finally we decided to implement these 3 operators, which we think they would reach to all the possible solutions:

\begin{enumerate}
\item \textbf{Move}: this operator lets us move any person that is not a driver from the car $i$ to another car $j$, in a pickup place $k$ and a drop off place $l$.  
\item \textbf{Swap inside}: this operator lets us swap the order of the people inside a car $i$.
\item \textbf{Delete car}: this operator lets us delete a car whenever the car is only occuped by the driver. When the deletion is made the driver is inserted into another car. 
\end{enumerate}



\section{Generating successor states}
\section{Representation of the Goal State}
\section{Heuristics Function}
Once the representation of the solution state has been defined, the generation of the initial solution state and the operators on which we are going to work, we proceed into analysing the heuristic function. 

In order to solve the two solution criteria given in the statement, we must perform two different heuristics, because the final result that must be returned has different priorities. The heuristic function that will solve the first criterion will be called Heuristic Function 1, and the one that resolves the second, Heuristic Function 2. 

\subsection{Heuristic Function 1}

The criterion that this function must follow is quite simple, the objective is to minimize the sum of all the distances that each car has to do.

To follow this criterion, we...

\subsection{Heuristic Function 2}

For the second heuristic we have added another criterion in order to minimize also the number of cars that are driving. 


\section{Experiment 1}
In this experiment we will decide which is the best operator of the different ones we have created using the \textit{Heuristic Function 1}. 
\\
\medskip

This experiment is going to be made using \textbf{200 people }($N$), and \textbf{100 drivers }($M$) and only the \textbf{Hill Climbing algorithm}. In order to perform it, firstly, we have generated an initial solution. From all the possible initial solution generators that we have implemented, we have chosen the first one, which BLABLABLA since we believe that is the one that gives us the best results. 

As we mentioned in the previous section \textit{Analysis of our operators}, we have three different operators. In order to try out which set of operators is the best one, we have automatized a process where all different operators are applied to the scenery using different seeds to see which one gives us better results and better time. 

Our \textbf{hypothesis} is that a combination of all of them will gives us the best results. 


\section{Experiment 2}
We did this experiment in order to know which was the most suitable way to generate our initial solution. In this experiment we will use the best set of operators available found in the previous experiment.

We will use the same scenery that was used in the first experiment ($N=200$ and $M=100$).  In order to try all the different initial solution generators we have created a process where the same scenary is applied to different initial solution methods to see which one gives us better results and better time. 

Our \textbf{hypothesis} is that...


\section{Experiment 3}

A really important part about this project is to be able to determine the parameters that are going to be used for the \textbf{Simulated Annealing algorithm}, so that its results are the best possible, that is, the minimum number of cars driving the shortest amount of distance and everybody getting to their workplace in a reasonable execution time. 
\\
\medskip

The algorithm works with 4 parameters:
\begin{enumerate}
\item \textbf{Steps}: The total number of iterations that the algorithm will perform. 
\item \textbf{Number of iterations for each temperature change}: Whenever there is a temperature change, a constant number of iterations will be made in which the probability of choosing a worse successor is kept. 
\\
Each time this number of iterations is executed, the probability of choosing a worse state decreases. 
\item \textbf{k}: parameter of the state acceptance function that affects the probability of choosing a worse succesor state. We know that the higher the value of the parameter, the longer it takes for the probability of staying with a worse successor state to decrease. 

\item \textbf{$\lambda$}: Another parameter of the state acceptance function that affects the probability of choosing a worse successor. The higher the value of $\lambda$, the less it will take to decrease the probability of accepting a worse successor state. 


\end{enumerate}

\section{Experiment 4}



\section{Experiment 5}


\section{Experiment 6}


\section{Experiment 7}


\section{Especial Experiment}

At this point we have degined the best initial state, its operators, the heuristic algorithm and Hill Climbing and Simulated Annealing with the most appropiate parameters, so we can proceed to compare algorithms. 


\subsection{Hill Climbing}

The experiment was made configuring our environment with 200 people, 100 drivers and seed 1234.
\\

We would like to add that these results are a valid solution because no car drives more than 30 km and there is not any moment where a car carries more than 2 people. 
\\

\begin{table}[h]
\centering
\begin{tabular}{|l|l|l|l|}
\hline \textbf{Time} &
 \textbf{Nodes expanded} & \textbf{Cars} & \textbf{Distance}\\  \hline
6054 ms &  17 & 92 & 1834.3 km \\ \hline
\end{tabular}
\caption{Results of our experiments with Hill Climbing}
\label{Results}
\end{table}

\subsection{Simulated annealing}
The experiment was made configuring our environment with 200 people, 100 drivers and seed 1234.
\\


\begin{table}[h]
\centering
\begin{tabular}{|l|l|l|l|l|l|}
\hline & \textbf{Time}  & \textbf{Cars} & \textbf{Distance} & \textbf{Solution}\\  \hline
 \#1 & 2596 ms  & 62 & 1671.3 km & Yes \\ \hline
 \#2 & 1218 ms & 64 & 1678.2 km & Yes \\ \hline
  \#3 & 1044 ms & 67 & 1753.3 km & Yes \\ \hline
 \#4 & 1088 ms & 65 & 1734.8 km & Yes \\ \hline
 \#5 & 1058 ms & 63 & 1731.1 km & No \\ \hline
 \#6 & 1131 ms & 65 & 1685.2 km & Yes \\ \hline
 \#7 & 1029 ms & 65 & 1720.5 km & Yes \\ \hline
 \#8 & 1067 ms & 66 & 1777.1 km & Yes \\ \hline
 \#9 & 1088 ms & 64 & 1657.6 km & Yes\\ \hline
 \#10 & 2596 ms & 65 & 1688.5 km & Yes \\ \hline

\end{tabular}
\caption{Results of our experiments with Simulated Annealing}
\label{Results2}
\end{table}

The mean time of our executions using Simulated Annealing is 1709.76 ms. 




\end {document}